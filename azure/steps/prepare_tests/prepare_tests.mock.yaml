parameters:
  timeoutInMinutes: 5
steps:
  - bash: |
      echo "reposRoot: $(_crux_repos_root), repoName: $(repoName)"
      echo "-- Unpacking crux and test repo to correct folders"
      mkdir -p $(_crux_repos_root) &> /dev/null && cp -r $(repoName) $(System.DefaultWorkingDirectory)/$(_crux_repos_root)/$(repoName) # reposRoot empty so supressing errors in mkdir
      cp -r $(cruxRepoName)/* $(System.DefaultWorkingDirectory)/

      #mock set-up for tests
      echo "-- Creating mock dir"
      mkdir -p $(mock_dir)

      #loading properties from crux.properties
      echo "-- Parsing crux.propeties"
      cp azure/steps/test_data/crux.properties $(_crux_properties_file)
      cat $(_crux_properties_file)
      awk -F= '{print "echo ##vso[task.setvariable variable="$1"]"$2}' $(_crux_properties_file) >> vars.txt && cat vars.txt



    displayName: PREPARE tests (mocked)
    timeoutInMinutes: ${{ parameters.timeoutInMinutes }}
    condition: and(succeeded(), not(eq(variables.prepare_tests, false)))