parameters:
  - name: mode
    displayName: 'Which template to use ?'
    type: string
    default: jmeter

variables:
  reposRoot: repos
  report_dir: kubernetes/tmp/report
  results: kubernetes/tmp/results.csv
  log: kubernetes/tmp/jmeter.log
  errors: kubernetes/tmp/errors.xml
  scale_down_replicas: 0
  scale_up_replicas_master: 1
  service: jmeter-slaves
  service-master: jmeter-master
  armModulePath: $(System.DefaultWorkingDirectory)/pipelines/azure/arm
  k8conn: k8_$(Build.BuildID)
  ${{ if eq(parameters.mode,'tests') }}:
    crux_clone: true
    tests_clone: true
    prepare_tests: true
    create_cluster: false
    configure_cluster: false
    deploy_to_cluster: false
    delete_cluster: false
    jmeter_tests: false
    archive_jmeter_report: false
    archive_results_file: false
    archive_log: false
    archive_errors: false
    evaluate_as_junit_tests: false
    publish_junit_results: false

  ${{ if eq(parameters.mode,'jmeter') }}:
    crux_clone: true
    tests_clone: true
    prepare_tests: true
    create_cluster: false
    configure_cluster: true
    deploy_to_cluster: true
    delete_cluster: false
    jmeter_tests: true
    archive_jmeter_report: true
    archive_results_file: true
    archive_log: true
    archive_errors: true
    evaluate_as_junit_tests: true
    publish_junit_results: true

  ${{ if eq(parameters.mode,'jmeter_dynamic') }}:
    crux_clone: true
    tests_clone: true
    prepare_tests: true
    create_cluster: true
    configure_cluster: false
    deploy_to_cluster: true
    delete_cluster: true
    jmeter_tests: true
    archive_jmeter_report: true
    archive_results_file: true
    archive_log: true
    archive_errors: true
    evaluate_as_junit_tests: true
    publish_junit_results: true